#!/bin/bash
# Post-installation script for NetSnmp Enterprise

set -e

# Colors
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m'

echo -e "${BLUE}NetSnmp Enterprise Post-installation Setup${NC}"

# Create directories if they don't exist
mkdir -p /etc/netsnmp
mkdir -p /var/cache/netsnmp
mkdir -p /var/log

# Set proper permissions
chmod 755 /var/cache/netsnmp
chmod 755 /etc/netsnmp

# Create default config if it doesn't exist
if [[ ! -f /etc/netsnmp/netsnmp.conf ]]; then
    echo -e "${BLUE}Creating default configuration...${NC}"
    cat > /etc/netsnmp/netsnmp.conf << 'EOF'
# NetSnmp Enterprise Configuration
subnets="192.168.1.0/24 10.0.0.0/24"
communities="public private"
ping_timeout="1"
snmp_timeout="2"
scan_workers="10"
cache_ttl="3600"
enable_logging="true"
EOF
    chmod 644 /etc/netsnmp/netsnmp.conf
fi

# Create log file
touch /var/log/netsnmp.log
chmod 644 /var/log/netsnmp.log

echo -e "${GREEN}Post-installation setup completed successfully!${NC}"
echo ""
echo "Next steps:"
echo "  1. Configure: sudo netsnmp --wizard"
echo "  2. Scan network: sudo netsnmp --update"
echo "  3. Search devices: netsnmp switch"
echo ""
echo "Documentation: /usr/share/doc/netsnmp-enterprise/INSTALL.md"